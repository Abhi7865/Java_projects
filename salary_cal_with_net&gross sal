/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.jdbc;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import javax.swing.JOptionPane;

/**
 *
 * @author ANHIJEET
 */
public class emp_salary extends javax.swing.JFrame {
    int salary,da,hra,pf,pt,it,net,gross;

    /**
     * Creates new form emp_salary
     */
    public emp_salary() {
        initComponents();
    }
   

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">                          
    private void initComponents() {

        sclpan = new javax.swing.JScrollPane();
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        lbl_id = new javax.swing.JLabel();
        lbl_name = new javax.swing.JLabel();
        lbl_basic = new javax.swing.JLabel();
        lbl_da = new javax.swing.JLabel();
        lbl_hra = new javax.swing.JLabel();
        lbl_pf = new javax.swing.JLabel();
        lbl_it = new javax.swing.JLabel();
        lbl_pt = new javax.swing.JLabel();
        btn_net = new javax.swing.JButton();
        btn_gross = new javax.swing.JButton();
        txt_net = new javax.swing.JTextField();
        txt_gross = new javax.swing.JTextField();
        btn_save = new javax.swing.JButton();
        btn_search = new javax.swing.JButton();
        btn_update = new javax.swing.JButton();
        btn_delete = new javax.swing.JButton();
        btn_clear = new javax.swing.JButton();
        txt_id = new javax.swing.JTextField();
        txt_name = new javax.swing.JTextField();
        txt_basic = new javax.swing.JTextField();
        txt_da = new javax.swing.JTextField();
        txt_hra = new javax.swing.JTextField();
        txt_pf = new javax.swing.JTextField();
        txt_it = new javax.swing.JTextField();
        txt_pt = new javax.swing.JTextField();
        btn_new = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jPanel1.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel1.setText("EMPLOYEE SALARY MANAGEMENT");
        jPanel1.add(jLabel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(210, 20, -1, -1));

        lbl_id.setText("ID :");
        jPanel1.add(lbl_id, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 80, -1, -1));

        lbl_name.setText("NAME");
        jPanel1.add(lbl_name, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 130, -1, -1));

        lbl_basic.setText("BASIC SAL");
        jPanel1.add(lbl_basic, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 180, -1, -1));

        lbl_da.setText("DA ");
        jPanel1.add(lbl_da, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 230, -1, -1));

        lbl_hra.setText("HRA");
        jPanel1.add(lbl_hra, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 280, -1, -1));

        lbl_pf.setText("PF");
        jPanel1.add(lbl_pf, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 340, -1, -1));

        lbl_it.setText("IT");
        jPanel1.add(lbl_it, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 390, -1, -1));

        lbl_pt.setText("PT");
        jPanel1.add(lbl_pt, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 450, -1, -1));

        btn_net.setText("NET SAL");
        btn_net.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_netActionPerformed(evt);
            }
        });
        jPanel1.add(btn_net, new org.netbeans.lib.awtextra.AbsoluteConstraints(60, 520, -1, -1));

        btn_gross.setText("GROSS SAL");
        btn_gross.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_grossActionPerformed(evt);
            }
        });
        jPanel1.add(btn_gross, new org.netbeans.lib.awtextra.AbsoluteConstraints(240, 520, -1, -1));
        jPanel1.add(txt_net, new org.netbeans.lib.awtextra.AbsoluteConstraints(60, 582, 90, 30));
        jPanel1.add(txt_gross, new org.netbeans.lib.awtextra.AbsoluteConstraints(240, 582, 100, 30));

        btn_save.setText("SAVE");
        btn_save.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_saveActionPerformed(evt);
            }
        });
        jPanel1.add(btn_save, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 680, -1, -1));

        btn_search.setText("SEARCH");
        btn_search.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_searchActionPerformed(evt);
            }
        });
        jPanel1.add(btn_search, new org.netbeans.lib.awtextra.AbsoluteConstraints(120, 680, -1, -1));

        btn_update.setText("UPDATE");
        btn_update.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_updateActionPerformed(evt);
            }
        });
        jPanel1.add(btn_update, new org.netbeans.lib.awtextra.AbsoluteConstraints(250, 680, -1, -1));

        btn_delete.setText("DELETE");
        btn_delete.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_deleteActionPerformed(evt);
            }
        });
        jPanel1.add(btn_delete, new org.netbeans.lib.awtextra.AbsoluteConstraints(370, 680, -1, -1));

        btn_clear.setText("CLEAR");
        btn_clear.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_clearActionPerformed(evt);
            }
        });
        jPanel1.add(btn_clear, new org.netbeans.lib.awtextra.AbsoluteConstraints(500, 680, -1, -1));
        jPanel1.add(txt_id, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 80, 120, 30));
        jPanel1.add(txt_name, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 120, 120, 30));

        txt_basic.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txt_basicFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                txt_basicFocusLost(evt);
            }
        });
        txt_basic.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txt_basicActionPerformed(evt);
            }
        });
        jPanel1.add(txt_basic, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 170, 120, 30));
        jPanel1.add(txt_da, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 220, 120, 30));
        jPanel1.add(txt_hra, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 272, 120, 30));
        jPanel1.add(txt_pf, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 332, 120, 30));
        jPanel1.add(txt_it, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 390, 120, 30));
        jPanel1.add(txt_pt, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 440, 120, 30));

        btn_new.setText("NEW");
        btn_new.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_newActionPerformed(evt);
            }
        });
        jPanel1.add(btn_new, new org.netbeans.lib.awtextra.AbsoluteConstraints(590, 680, -1, -1));

        sclpan.setViewportView(jPanel1);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(sclpan, javax.swing.GroupLayout.DEFAULT_SIZE, 681, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(sclpan, javax.swing.GroupLayout.DEFAULT_SIZE, 774, Short.MAX_VALUE)
        );

        pack();
    }// </editor-fold>                        

    private void btn_netActionPerformed(java.awt.event.ActionEvent evt) {                                        
        // TODO add your handling code here:
        
         net=salary+da+hra+pf+it+pt;
         txt_net.setText(String.valueOf(net));
   
    }                                       

    private void btn_grossActionPerformed(java.awt.event.ActionEvent evt) {                                          
        // TODO add your handling code here:
         gross=salary+da+hra;
	txt_gross.setText(String.valueOf(gross));
    }                                         

    private void btn_clearActionPerformed(java.awt.event.ActionEvent evt) {                                          
        // TODO add your handling code here:
        txt_basic.setText(" ");
        txt_id.setText(" ");
        txt_name.setText(" ");
        txt_da.setText(" ");
        txt_hra.setText(" ");
        txt_pf.setText(" ");
        txt_pt.setText(" ");
        txt_it.setText(" ");
        txt_gross.setText(" ");
        txt_net.setText(" ");
        
    }                                         

    private void btn_deleteActionPerformed(java.awt.event.ActionEvent evt) {                                           
        // TODO add your handling code here:
        try{
            Class.forName("com.mysql.jdbc.Driver");
            Connection con=DriverManager.getConnection("jdbc:mysql://localhost:3306/student_batch7", "root", "");
            String sql="delete from emp_sal where id='"+txt_id.getText()+"' ";
            PreparedStatement pst=con.prepareStatement(sql);
            int i=pst.executeUpdate();
            if(i>0){
                JOptionPane.showMessageDialog(null, "Record Deleted");
            }
            
                    
            
        }catch(Exception e1){
            JOptionPane.showMessageDialog(null, e1.getMessage());
        }
    }                                          

    private void btn_updateActionPerformed(java.awt.event.ActionEvent evt) {                                           
        // TODO add your handling code here:
           try{
            Class.forName("com.mysql.jdbc.Driver");
            Connection con=DriverManager.getConnection("jdbc:mysql://localhost:3306/student_batch7", "root", "");
             String sql="update emp_sal set name='"+txt_name.getText()+"', basicsal='"+txt_basic.getText()+"', DA='"+txt_da.getText()+"', HRA='"+txt_hra.getText()+"', PF='"+txt_pf.getText()+"', IT='"+txt_it.getText()+"', PT='"+txt_pt.getText()+"', NET='"+txt_net.getText()+"', GROSS='"+txt_gross.getText()+"' where id='"+txt_id.getText()+"'";
             PreparedStatement pst=con.prepareStatement(sql);
             int i=pst.executeUpdate();
             if(i>0){
                 JOptionPane.showMessageDialog(null,"Record Update");
             }
             
            
            
        }catch(Exception e1){
            JOptionPane.showMessageDialog(null, e1.getMessage());
        }
  
    }                                          

    private void btn_searchActionPerformed(java.awt.event.ActionEvent evt) {                                           
        // TODO add your handling code here:
        try{
            Class.forName("com.mysql.jdbc.Driver");
            Connection con=DriverManager.getConnection("jdbc:mysql://localhost:3306/student_batch7", "root", "");
            String sql="select * from emp_sal where id= '"+txt_id.getText()+"'";
            PreparedStatement pst=con.prepareStatement(sql);
            ResultSet rs=pst.executeQuery();
            int status=0;
            while(rs.next()){
                status +=1;
                txt_name.setText(rs.getString("name"));
                txt_basic.setText(rs.getString("basicsal"));
                txt_da.setText(rs.getString("DA"));
                txt_hra.setText(rs.getString("HRA"));
                txt_pf.setText(rs.getString("PF"));
                txt_it.setText(rs.getString("IT"));
                txt_pt.setText(rs.getString("PT"));
                txt_net.setText(rs.getString("NET"));
                txt_gross.setText(rs.getString("GROSS"));
                
                
                
            }
            
        }catch(Exception e1){
            JOptionPane.showMessageDialog(null, e1.getMessage());
        }
        
    }                                          

    private void btn_saveActionPerformed(java.awt.event.ActionEvent evt) {                                         
        // TODO add your handling code here:
           try{
            Class.forName("com.mysql.jdbc.Driver");
            Connection con=DriverManager.getConnection("jdbc:mysql://localhost:3306/student_batch7", "root", "");
             String sql="insert into emp_sal(id,name,basicsal,DA,HRA,PF,IT,PT,NET,GROSS) values('"+txt_id.getText()+"', '"+txt_name.getText()+"','"+txt_basic.getText()+"', '"+txt_da.getText()+"', '"+txt_hra.getText()+"', '"+txt_pf.getText()+"', '"+txt_it.getText()+"', '"+txt_pt.getText()+"', '"+txt_net.getText()+"', '"+txt_gross.getText()+"')";
            PreparedStatement pst=con.prepareStatement(sql);
            int i=pst.executeUpdate();
            if(i>0){
                JOptionPane.showMessageDialog(null, "Record Saved");
            }
                   
            
        }catch(Exception e1){
            JOptionPane.showMessageDialog(null, e1.getMessage());
        }
   
    }                                        

    private void btn_newActionPerformed(java.awt.event.ActionEvent evt) {                                        
        // TODO add your handling code here:
          try{
            Class.forName("com.mysql.jdbc.Driver");
            Connection con=DriverManager.getConnection("jdbc:mysql://localhost:3306/student_batch7", "root", "");
            String sql="select max(id) from emp_sal";
            PreparedStatement pst=con.prepareStatement(sql);
            ResultSet rs=pst.executeQuery();
            while(rs.next()){
                int a=Integer.parseInt(rs.getString(1));
                txt_id.setText(""+(a+1));
                
            }
            
        }catch(Exception e1){
            JOptionPane.showMessageDialog(null, e1.getMessage());
        }
    }                                       

    private void txt_basicActionPerformed(java.awt.event.ActionEvent evt) {                                          
        // TODO add your handling code here:
    }                                         

    private void txt_basicFocusLost(java.awt.event.FocusEvent evt) {                                    
        // TODO add your handling code here:
        salary=Integer.parseInt(txt_basic.getText());
		 da=(salary/100)*110;
		txt_da.setText(String.valueOf(da));
		 hra=(salary/100)*20;
		txt_hra.setText(String.valueOf(hra));
		
		txt_pf.setText("1800");
		 pf=Integer.parseInt(txt_pf.getText());
		txt_it.setText("1500");
		 it=Integer.parseInt(txt_it.getText());
		txt_pt.setText("200");
		 pt=Integer.parseInt(txt_pt.getText());
    }                                   

    private void txt_basicFocusGained(java.awt.event.FocusEvent evt) {                                      
        // TODO add your handling code here:
    }                                     

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(emp_salary.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(emp_salary.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(emp_salary.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(emp_salary.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new emp_salary().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify                     
    private javax.swing.JButton btn_clear;
    private javax.swing.JButton btn_delete;
    private javax.swing.JButton btn_gross;
    private javax.swing.JButton btn_net;
    private javax.swing.JButton btn_new;
    private javax.swing.JButton btn_save;
    private javax.swing.JButton btn_search;
    private javax.swing.JButton btn_update;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JLabel lbl_basic;
    private javax.swing.JLabel lbl_da;
    private javax.swing.JLabel lbl_hra;
    private javax.swing.JLabel lbl_id;
    private javax.swing.JLabel lbl_it;
    private javax.swing.JLabel lbl_name;
    private javax.swing.JLabel lbl_pf;
    private javax.swing.JLabel lbl_pt;
    private javax.swing.JScrollPane sclpan;
    private javax.swing.JTextField txt_basic;
    private javax.swing.JTextField txt_da;
    private javax.swing.JTextField txt_gross;
    private javax.swing.JTextField txt_hra;
    private javax.swing.JTextField txt_id;
    private javax.swing.JTextField txt_it;
    private javax.swing.JTextField txt_name;
    private javax.swing.JTextField txt_net;
    private javax.swing.JTextField txt_pf;
    private javax.swing.JTextField txt_pt;
    // End of variables declaration                   
}
